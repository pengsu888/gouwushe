<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0" />
    <title>优选商城</title>
    <link rel="stylesheet" type="text/css" href="../../css/api.css" />
    <link rel="stylesheet" type="text/css" href="../../css/swiper.min.css" />
</head>
<style type="text/css">
    body {
        height: 100%;
        width: 100%;
        /*background: #f4f4f4;*/
        overflow-x: hidden;
        overflow-y: auto;
    }

    .aui-flexView {
        width: 100%;
        /* height: 100%; */
        margin: 0 auto;
        display: -webkit-box;
        display: -webkit-flex;
        display: -ms-flexbox;
        display: flex;
        flex-direction: column;
        background: #1a1a1a url(../../image/vip_mall/index_bg.b11e752f.jpg) repeat-y;
        background-size: 100% auto;
    }

    .aui-scrollView {
        width: 100%;
        /* height: 100%; */
        flex: 1;
        overflow-y: auto;
        overflow-x: hidden;
        position: relative;
    }

    .gradient-red {
        overflow: hidden;
        /*position: absolute;
        top: 0;
        left: 25%;
        width: 50%;
        height: 100%;*/
        /*background-image: linear-gradient(180deg, #fe5461, #191919);*/
    }

    .aui-flex {
        display: flex;
        padding: 15px;
        position: relative;
    }

    .aui-shop-user {
        width: 80px;
        height: 80px;
        margin-right: 1rem;
    }

    .aui-shop-user img {
        width: 70px;
        height: 70px;
        border-radius: 100%;
        border: 5px solid #FFE1D0;
    }

    .aui-flex-box {
        flex: 1;
        min-width: 0;
        font-size: 14px;
        color: #ffffff;
    }

    .aui-flex-box h2 {
        font-size: 1.2rem;
        margin-bottom: 0.8rem;
    }

    .aui-vip-box {
        overflow: hidden;
        position: relative;
    }

    .aui-vip-box em {
        float: left;
        border: 1px solid #ffc467;
        border-radius: 20px;
        padding: 0.01rem 0.6rem;
        color: #ecd496;
        font-size: 0.9rem;
        margin-right: 0.5rem;
        margin-bottom: 0.8rem;
    }

    .aui-vip-box i {
        float: left;
        font-size: 0.85rem;
        color: #ffffff;
        font-style: normal;
        line-height: 1.5rem;
        /*padding-left: 0.5rem;*/
    }

    .aui-flex-mar {
        margin-bottom: 1rem;
    }

    .aui-flex-box-one {
        background-image: url(../../image/vip_mall/vip-001.png);
        background-size: cover;
        border-radius: 5px;
        padding: 1.2rem 0;
        margin-right: 0.4rem;
    }

    .aui-flex-box h3 {
        /* height: 30px; */
        color: #ffffff;
        font-size: 0.85rem;
        padding-left: 1.5rem;
        font-weight: normal;
    }

    .icon {
        width: 20px;
        height: 20px;
        display: block;
        border: none;
        float: left;
        background-size: 20px;
        background-repeat: no-repeat;
    }

    .icon-order {
        background-size: 22px;
        width: 28px;
        height: 28px;
        margin-right: 0.2rem;
        background-image: url(../../image/vip_mall/icon-order.png);
    }

    .aui-flex-box-two {
        background-image: url(../../image/vip_mall/vip-002.png);
        background-size: cover;
        border-radius: 5px;
        padding: 1.2rem 0;
        margin-left: 0.4rem;
    }

    .icon-full {
        background-size: 23px;
        width: 30px;
        height: 30px;
        margin-right: 0.2rem;
        background-image: url(../../image/vip_mall/icon-full.png);
    }

    .pos1 {
        top: 0rem;
        right: -1.5rem;
    }

    .ellipse {
        position: absolute;
        top: 1.2rem;
        width: 9rem;
        height: 7.1rem;
        border-radius: 50%;
        opacity: .23;
        /*background-image: linear-gradient(91deg, #c7252b, #ff333a);*/
        z-index: 3;
    }

    .pos2 {
        top: 0rem;
        right: -3.5rem;
    }

    .title-type1 {
        display: -ms-flexbox;
        display: flex;
        -ms-flex-align: center;
        align-items: center;
        -ms-flex-pack: center;
        justify-content: center;
        font-size: 1.3rem;
        color: #ffe1a6;
        line-height: 1;
        white-space: nowrap;
        padding: 1rem;
        /*background-color: #191919;*/
    }

    .title-type1:before {
        content: " ";
        width: .6rem;
        height: .6rem;
        margin-right: .8rem;
        background: url(../../image/vip_mall/icon_title_l.c5982a24.svg) no-repeat 50%;
        background-size: contain;
    }

    .title-type1:after {
        content: " ";
        width: .6rem;
        height: .6rem;
        margin-left: .8rem;
        background: url(../../image/vip_mall/icon_title_r.465996c6.svg) no-repeat 50%;
        background-size: contain;
    }
    /*.broadcast {
    position: fixed;
    top: 4.3rem;
    left: .2rem;
    z-index: 900;
}
    .broadcast .bar {
    display: -ms-flexbox;
    display: flex;
    -ms-flex-align: center;
    align-items: center;
    background: #ffffff;
    border-radius: .7rem;
    transition: all .4s;
    opacity: 1;
}
    .broadcast .bar.hide{opacity:0}
    .broadcast .bar .user-avatar {
    width: 1.2rem;
    height: 1.2rem;
    margin: .1rem;
    border-radius: 50%;
}
    .broadcast .bar .user-avatar img {
    border: none;
    vertical-align: middle;
}
    .broadcast .bar .user-name {
    padding: 0 .4rem;
    font-size: .6rem;
    color: #333;
}*/

    .main-title-wrap {
        position: relative;
        margin-top: 1.4rem;
        z-index: 13;
        text-align: center;
    }

    .main-title-wrap .title1 {
        display: -ms-flexbox;
        display: flex;
        -ms-flex-align: center;
        align-items: center;
        -ms-flex-pack: center;
        justify-content: center;
        margin-bottom: .8rem;
        font-size: .9rem;
        color: #333;
        line-height: 1;
    }

    .main-title-wrap .title1:after,
    .main-title-wrap .title1:before {
        content: "";
        width: 3.75rem;
        height: .35rem;
        background: url(../../image/vip_mall/icon_title_line.db1996fa.svg) no-repeat 50%;
        background-size: contain;
    }

    .main-title-wrap .title1:after {
        margin-left: .5rem;
        transform: rotate(180deg);
    }

    .main-title-wrap .title1:before {
        margin-right: .5rem;
    }

    .goods_list {
        height: auto;
        width: 100%;
        font-size: 14px;
        overflow: hidden;
        background: #fff;
        margin-top: 10px;
        padding-top: 10px;
    }

    .listItem {
        width: calc(100% - 24px);
        padding-bottom: 10px;
        height: auto;
        overflow: hidden;
        margin: 0 auto;
        background: #fff;
    }

    .goods_img {
        width: calc(100% - 0px);
        margin: 0 auto;
        height: 120px;
        background: #f4f4f4;
    }

    .goods_img img {
        width: 100%;
        height: 100%;
        background-size: 100% 00%;
    }

    .goods_title {
        width: 100%;
        height: auto;
        line-height: 20px;
        margin-top: 5px;
    }

    .goods_price {
        width: 100%;
        height: auto;
        line-height: 25px;
        color: #999;
    }

    .goods_price .goods_discount {
        color: red;
    }

    .vip_del {
        width: 100%;
        height: 25px;
        color: #999;
        line-height: 25px;
        margin-top: 10px;
    }

    .vip_level {
        width: 14px;
        height: 14px;
        margin-right: 5px;
    }

    .vip_level img {
        width: 100%;
        height: 100%;
        background-size: 100% 100%;
        vertical-align: middle;
    }

    .buy_btn {
        width: 80px;
        height: 20px;
        border: solid 1px #FA4D2D;
        line-height: 20px;
        text-align: center;
        float: right;
        color: #FA4D2D;
        font-size: 12px;
        border-radius: 10px;
    }

    .vip_left {
        width: auto;
        height: 25px;
        float: left;
        overflow: hidden;
    }

    .red_color {
        color: red;
    }

    .picture {
        width: 100%;
        height: auto;
        background: 100% 100%;
    }

    .picture img {
        width: 100%;
        height: auto;
        background: 100% 100%;
    }
    /*轮播图*/

    .meitu {
        margin: 1.2rem .6rem;
        background: #1a1a1a;
        border: 1px solid #998763;
        border-radius: 10px;
    }

    .swiper-container {
        width: 100%;
        height: 100%;
        margin-left: auto;
        margin-right: auto;
        border-radius: 10px;
    }

    .swiper-container-bottom {
        width: 100%;
        height: 100%;
        margin-left: auto;
        margin-right: auto;
    }

    .swiper-slide {
        text-align: center;
        font-size: 18px;
        background: #f4f4f4;
        /* Center slide text vertically */
        display: -webkit-box;
        display: -ms-flexbox;
        display: -webkit-flex;
        display: flex;
        -webkit-box-pack: center;
        -ms-flex-pack: center;
        -webkit-justify-content: center;
        justify-content: center;
        -webkit-box-align: center;
        -ms-flex-align: center;
        -webkit-align-items: center;
        align-items: center;
    }

    .swiper-slide img {
        width: 100%;
        height: 100%;
        background-size: 100% 100%;
        background-color: #1a1a1a;
    }
</style>

<body>
    <div class="aui-flexView">
        <div class="aui-scrollView">
            <div class="gradient-red">
                <div class="aui-flex" style="padding-top: 20px;">
                    <div class="aui-shop-user">
                        <img src="../../image/home/v2_ic_avatar.png" alt="" id="user_headImg">
                    </div>
                    <div class="aui-flex-box">
                        <h2 id="nickname"></h2>
                        <div class="aui-vip-box">
                            <em id="rankName"></em>
                            <i id="validity"></i>
                        </div>
                    </div>
                </div>
                <div class="aui-flex aui-flex-mar">
                    <div tapmode onclick="fnOpenyxdd();" class="aui-flex-box aui-flex-box-one">
                        <h3><i class="icon icon-order"></i>我的优选订单</h3>
                    </div>
                    <div tapmode onclick="fnOpenVIPyqm();" class="aui-flex-box aui-flex-box-two">
                        <h3><i class="icon icon-full"></i>我的VIP邀请码</h3>
                    </div>
                </div>
                <div class="ellipse ellipse1 pos1"></div>
                <div class="ellipse ellipse2 pos2"></div>
            </div>
        </div>
        <!-- <section class="broadcast" style="">
   <div class="bar">
    <img class="user-avatar" src="http://thirdwx.qlogo.cn/mmopen/vi_32/JiaiagbNBeib5M20o6PKwI2ImzmyeAbdTibjF13E2SSbzA6JAB2efrOInJxm58e7SmqD5iaZ3xc5T0SZaLWk0Y4Tb0g/132" />
    <span class="user-name">飘飘** 刚刚成为了券券推VIP</span>
   </div>
  </section> -->
        <div class="title-type1">尊享超级权益</div>
        <div class="meitu" id="banner">
            <div class="swiper-container">
                <div class="swiper-wrapper">
                    <div class="swiper-slide"><img src="../../image/lunbotu.jpg" alt=""></div>
                    <!-- <div class="swiper-slide"><img src="../../image/vip_mall/rights_vip2.488eb416.png" alt=""></div>
                    <div class="swiper-slide"><img src="../../image/vip_mall/rights_vip3.97ecebe5.png" alt=""></div> -->
                </div>
            </div>
        </div>
    </div>
    <!-- <div class="picture"> <img src="" alt="" id="picture"></div> -->
    <div id="bottom">
        <div class="swiper-container-bottom">
            <div class="swiper-wrapper">
                <div class="swiper-slide"><img src="../../image/lunbotu.jpg" alt=""></div>
            </div>
        </div>
    </div>
    <section class="main-title-wrap">
        <div class="title1 thin">优选专区-正品保障</div>
    </section>
    <div id="list">
        <!-- <div class="listItem">
            <div class="goods_img"><img src="../../image/zhanwei.jpg" alt=""></div>
            <div class="goods_title">&nbsp;&nbsp;【注册VIP赠品】门神蜂毒调理膏 环节疼痛疏通筋络 50G/瓶 2瓶装</div>
            <div class="goods_price"><span class="goods_discount">￥399</span>/赠798推推币</div>
            <div class="vip_del"><div class="vip_left"><span class="vip_level"><img src="../../image/ic_shop_zeng.jpg" alt=""></span><span>券券推VIP导购资格</span></div><div class="buy_btn">立即购买</div></div>
          </div>
          <div class="listItem">
            <div class="goods_img"><img src="../../image/zhanwei.jpg" alt=""></div>
            <div class="goods_title">&nbsp;&nbsp;【注册VIP赠品】门神蜂毒调理膏 环节疼痛疏通筋络 50G/瓶 2瓶装</div>
            <div class="goods_price"><span class="goods_discount">￥399</span>/赠798推推币</div>
            <div class="vip_del"><div class="vip_left"><span class="vip_level"><img src="../../image/ic_shop_zeng.jpg" alt=""></span><span>可获<span class="red_color">一个月</span>VIP权益</span></div><div class="buy_btn">立即购买</div></div>
          </div> -->
    </div>
    <div id="statu" style="font-size:0.8rem;color:#fd5f3e;background-color:#f5f5f5;height:30px;line-height:30px;text-align:center;clear:both;"><img src="../../image/loading.d997b79c.svg" alt="" style="width:1rem;height:1rem;vertical-align:middle;">加载中...</div>
    <!-- 商品列表部分 end-->
    <div class="noWlan">
        <div class="nowlanItem">
            <div class="no_net"><img src="../../image/no_net.png" /></div>
            <p class="no_p">网络竟然崩溃了</p>
            <p class="load_p">别紧张，试试看刷新页面</p>
            <div class="loadBtn" onclick="javascript:location.reload();">点击刷新</div>
        </div>
    </div>
</body>
<script type="text/javascript" src="../../script/api.js"></script>
<script type="text/javascript" src="../../script/jquery.js"></script>
<script type="text/javascript" src="../../script/api_common.js"></script>
<script type="text/javascript" src="../../script/md5.js"></script>
<script type="text/javascript" src="../../script/swiper.min.js"></script>
<script type="text/javascript">
    var user_id;
    var pageNum = 1;
    var isOver = false; //默认没有取完数据
    var statu; //滑到底部状态
    var rebate_name;
    apiready = function() {
        if (!empty($api.getStorage("userInfo"))) {
            user_id = $api.getStorage("userInfo").user_id;
        } else {
            user_id = "";
            checkUserLogin();
        }
        statu = $api.byId('statu');
        LoadingOne();
        getUserInfo(); //获取用户信息
        getLunbo(); //banner广告
        getLunboBottom(); //bottom广告
        loadFresh();
        loadMyFa(true);
        // 商品列表数据
        // 监听事件apiReady滚动到底部，加载更多功能
        api.addEventListener({
            name: 'scrolltobottom',
            extra: {
                threshold: 120 //设置距离底部多少距离时触发，默认值为0，数字类型
            }
        }, function(ret, err) {

            loadMyFa(false);
        });
    };

    //优选商城腰部广告
    function getLunbo() {
        var obj = {
            'type_id': 3,
            'plate_id': 9
        };
        var objArr = sort_ASCII(obj);
        var timestamp = fntimestamp();
        var version = '2.0';
        var arr = apiSecret + timestamp + version + '';
        for (i in objArr) {
            arr += objArr[i];
        }
        var sign = hex_md5(arr);
        api.ajax({
            url: commonUrl + 'soukeAppTttService/service/advert/ad_ac',
            method: 'post',
            headers: {
                'Content-Type': 'application/json;charset=utf-8'
            },
            data: {
                body: {
                    'apiKey': apiKey,
                    'timestamp': timestamp,
                    'sign': sign,
                    'type_id': 3,
                    'plate_id': 9
                }
            }
        }, function(ret, err) {
            if (ret) {
                if (ret.result_code == 200) {
                    var htmlLb = '';
                    console.log("优选商城腰部广告" + JSON.stringify(ret));
                    htmlLb += '<div class="swiper-container">';
                    htmlLb += '<div class="swiper-wrapper">';
                    for (var i = 0; i < ret.result_data.adlist.length; i++) {
                        htmlLb += '<div class="swiper-slide" adv_name="' + ret.result_data.adlist[i].adv_name + '" link_url="' + ret.result_data.adlist[i].link_url + '" id="' + ret.result_data.adlist[i].link_type_id +
                            '"><img src="' + ret.result_data.adlist[i].img_url + '" alt=""></div>';
                    }
                    htmlLb += '</div>';
                    htmlLb += '</div>';
                    $api.byId('banner').innerHTML = htmlLb;
                    var swiper = new Swiper('.swiper-container', {
                        loop: true, //无休止播放
                        autoHeight: true, //enable auto height   自动高度。设置为true时，wrapper和container会随着当前slide的高度而发生变化。
                        spaceBetween: 20, //在slide之间设置距离（单位px）。
                        pagination: { //使用分页器导航。分页器可使用小圆点样式（默认）、分式样式或进度条样式。
                            el: '.swiper-pagination',
                            clickable: true,
                            renderProgressbar: function(progressbarFillClass) {
                                return '<span class="' + progressbarFillClass + '"></span>';
                            }
                        },
                        autoplay: { //自动播放
                            delay: 2500,
                            disableOnInteraction: false,
                        },
                    });
                    $(".swiper-slide").click(function() {
                        var platetype = $(this).attr("id");
                        if (platetype == 1) { //自定义链接
                            var adv_name = $(this).attr("adv_name");
                            openWebUrl($(this).attr("link_url"), adv_name);
                        } else if (platetype == 2) { //淘宝板块
                            var adv_name = $(this).attr("adv_name");
                            var section_id = $(this).attr("link_url");
                            openSectionFrame(section_id, adv_name);
                        } else if (platetype == 3) { //淘宝商品ID
                            openGoodDel($(this).attr("link_url"), -1);
                        } else if (platetype == 4) { //跳转淘宝分类
                            var adv_name = $(this).attr("adv_name");
                            openFenlei_type($(this).attr("link_url"), adv_name);
                        } else if (platetype == 5) { //拼多多板块
                            var adv_name = $(this).attr("adv_name");
                            openPddSectionFrame($(this).attr("link_url"), adv_name);
                        } else if (platetype == 6) { //拼多多淘宝商品ID
                            openPddGoodDel($(this).attr("link_url"));
                        } else if (platetype == 7) { //拼多多分类
                            var adv_name = $(this).attr("adv_name");
                            openPddFenlei_type($(this).attr("link_url"), adv_name);
                        } else if (platetype == 8) { //不跳转
                        }
                    })
                } else {

                }
            } else {
                // api.alert({ msg: JSON.stringify(err) });
            }
        });
    }
    //优选商城底部广告
    function getLunboBottom() {
        var obj = {
            'type_id': 3,
            'plate_id': 10
        };
        var objArr = sort_ASCII(obj);
        var timestamp = fntimestamp();
        var version = '2.0';
        var arr = apiSecret + timestamp + version + '';
        for (i in objArr) {
            arr += objArr[i];
        }
        var sign = hex_md5(arr);
        api.ajax({
            url: commonUrl + 'soukeAppTttService/service/advert/ad_ac',
            method: 'post',
            headers: {
                'Content-Type': 'application/json;charset=utf-8'
            },
            data: {
                body: {
                    'apiKey': apiKey,
                    'timestamp': timestamp,
                    'sign': sign,
                    'type_id': 3,
                    'plate_id': 10
                }
            }
        }, function(ret, err) {
            if (ret) {
                if (ret.result_code == 200) {
                    var htmlLb = '';
                    console.log("优选商城底部广告" + JSON.stringify(ret));
                    htmlLb += '<div class="swiper-container-bottom">';
                    htmlLb += '<div class="swiper-wrapper">';
                    for (var i = 0; i < ret.result_data.adlist.length; i++) {
                        htmlLb += '<div class="swiper-slide" adv_name="' + ret.result_data.adlist[i].adv_name + '" link_url="' + ret.result_data.adlist[i].link_url + '" id="' + ret.result_data.adlist[i].link_type_id +
                            '"><img src="' + ret.result_data.adlist[i].img_url + '" alt=""></div>';
                    }
                    htmlLb += '</div>';
                    htmlLb += '</div>';
                    $api.byId('bottom').innerHTML = htmlLb;
                    var swiper = new Swiper('.swiper-container-bottom', {
                        // loop: true, //无休止播放
                        autoHeight: true, //enable auto height   自动高度。设置为true时，wrapper和container会随着当前slide的高度而发生变化。
                        spaceBetween: 20, //在slide之间设置距离（单位px）。
                        pagination: { //使用分页器导航。分页器可使用小圆点样式（默认）、分式样式或进度条样式。
                            el: '.swiper-pagination',
                            clickable: true,
                            renderProgressbar: function(progressbarFillClass) {
                                return '<span class="' + progressbarFillClass + '"></span>';
                            }
                        },
                        // autoplay: { //自动播放
                        //     delay: 2500,
                        //     disableOnInteraction: false,
                        // },
                    });
                    $(".swiper-slide").click(function() {
                        var platetype = $(this).attr("id");
                        if (platetype == 1) { //自定义链接
                            var adv_name = $(this).attr("adv_name");
                            openWebUrl($(this).attr("link_url"), adv_name);
                        } else if (platetype == 2) { //淘宝板块
                            var adv_name = $(this).attr("adv_name");
                            var section_id = $(this).attr("link_url");
                            openSectionFrame(section_id, adv_name);
                        } else if (platetype == 3) { //淘宝商品ID
                            openGoodDel($(this).attr("link_url"), -1);
                        } else if (platetype == 4) { //跳转淘宝分类
                            var adv_name = $(this).attr("adv_name");
                            openFenlei_type($(this).attr("link_url"), adv_name);
                        } else if (platetype == 5) { //拼多多板块
                            var adv_name = $(this).attr("adv_name");
                            openPddSectionFrame($(this).attr("link_url"), adv_name);
                        } else if (platetype == 6) { //拼多多淘宝商品ID
                            openPddGoodDel($(this).attr("link_url"));
                        } else if (platetype == 7) { //拼多多分类
                            var adv_name = $(this).attr("adv_name");
                            openPddFenlei_type($(this).attr("link_url"), adv_name);
                        } else if (platetype == 8) { //不跳转
                        }
                    })
                } else {

                }
            } else {
                // api.alert({ msg: JSON.stringify(err) });
            }
        });
    }

    //获取用户信息
    function getUserInfo() {
        var obj = {
            'user_id': user_id
        };
        var objArr = sort_ASCII(obj);
        var timestamp = fntimestamp();
        var version = '2.0';
        var arr = apiSecret + timestamp + version + '';
        for (i in objArr) {
            arr += objArr[i];
        }
        var sign = hex_md5(arr);
        api.ajax({
            url: commonUrl + 'soukeAppTttService/service/user/message_ac',
            method: 'post',
            headers: {
                'Content-Type': 'application/json;charset=utf-8'
            },
            data: {
                body: {
                    'apiKey': apiKey,
                    'timestamp': timestamp,
                    'sign': sign,
                    'user_id': user_id,
                }
            }
        }, function(ret, err) {
            if (ret) {
                if (ret.result_code == 200) {
                    console.log("用户信息" + JSON.stringify(ret));
                    $("#user_headImg").attr("src", ret.result_user.head);
                    var nickname = ret.result_user.nickname;
                    if (nickname.length > 12) {
                        nickname = nickname.substring(0, 11) + "..."
                    } else {
                        nickname = nickname;
                    }
                    $api.byId('nickname').innerHTML = nickname;
                    is_accredit = ret.result_user.is_accredit;
                    if (empty(ret.result_user.phone)) {
                        is_phone = 0;
                    } else {
                        is_phone = 1;
                    }
                    $(".head_user_name").html(nickname);
                    $("#rankName").show();
                    $api.byId('rankName').innerHTML = ret.result_user.rankName;
                    $("#validity").show();
                    $api.byId('validity').innerHTML = ret.validity;
                    // if(empty(ret.validity)){
                    //   $(".vip_data").html('<div class="vip_left">您已获得升级VIP资格 </div> <div class="vip_tq" tapmode onclick="fnOpenVIP();">立即升级></div>');
                    // }else{
                    // $(".vip_data").html('<div class="vip_left">'+ret.validity+' </div> <div class="vip_tq" tapmode onclick="fnOpenVIP();">查看特权></div>');
                    // }
                }
            }
        });
    }

    function loadFresh() {
        RefreshLoad();
    }

    function loadMyFa(isPull) {
        if (!isPull && isOver) {
            return;
        }
        //判断如果是下拉刷新，
        if (isPull) {
            pageNum = 1;
            isOver = false;
        }
        var obj = {
            'size': 10,
            'pageNo': pageNum,
        };
        var objArr = sort_ASCII(obj);
        var timestamp = fntimestamp();
        var version = '2.0';
        var arr = apiSecret + timestamp + version + '';
        for (i in objArr) {
            arr += objArr[i];
        }
        var sign = hex_md5(arr);
        // alert(sign);
        api.ajax({
            url: commonUrl + 'soukeAppTttService/service/singleitem/queryselfsingleitem_ac',
            method: 'post',
            headers: {
                'Content-Type': 'application/json;charset=utf-8'
            },
            data: {
                body: {
                    'apiKey': apiKey,
                    'timestamp': timestamp,
                    'sign': sign,
                    'size': 10,
                    'pageNo': pageNum,
                }
            }
        }, function(ret, err) {
            if (ret) {
                if (ret.result_code == 200) {
                    api.hideProgress();
                    $(".noWlan").hide();
                    console.log("商品信息-----：" + JSON.stringify(ret));
                    $("#picture").attr("src", ret.picture);
                    var data = ret.result_data;
                    rebate_name = ret.result_integer.unit + ret.result_integer.name;
                    if (data != "") {
                        $api.css(statu, 'display:block;');
                        pageNum++;
                    } else {
                        statu.innerHTML = "暂无数据";
                    }
                    if (data.length < 10 && data != "") {
                        statu.innerHTML = "已经到底啦 ~ 别扯了";
                        isOver = true;
                    }

                    fnShowData(data, isPull);
                } else {
                    api.toast({
                        msg: ret.result_message,
                        duration: 2000,
                        location: 'middle'
                    });

                }
            } else {
                $(".noWlan").show();
                // api.alert({ msg: JSON.stringify(err) });
            }
        });
    }

    function fnShowData(data, isPull) {
        var html = '';
        for (var i = 0; i < data.length; i++) {
            html += '<div class="goods_list">';
            html += '<div class="listItem" onclick="openVipGoodDel(' + data[i].id + ');">';
            html += '<div class="goods_img"><img src="' + data[i].sing_img.split(",")[0] + '" alt=""></div>';
            html += '<div class="goods_title">&nbsp;&nbsp;' + data[i].sing_title + '</div>';
            html += '<div class="goods_price"><span class="goods_discount">￥' + data[i].sing_price + '</span>';
            if (!empty(data[i].sing_integral)) {
                html += '/送' + data[i].sing_integral + rebate_name + '</div>';
            }
            if (data[i].effective_cycle == 1) {
                html += '<div class="vip_del"><div class="vip_left"><span class="vip_level"><img src="../../image/ic_shop_zeng.jpg" alt=""></span>可获<span class="red_color">' + data[i].effective_num + '个月</span>' + data[i].sk_dis_level.level_name +
                    '权益</div><div class="buy_btn">立即购买</div></div>';
            } else if (data[i].effective_cycle == 2) {
                html += '<div class="vip_del"><div class="vip_left"><span class="vip_level"><img src="../../image/ic_shop_zeng.jpg" alt=""></span>可获<span class="red_color">' + data[i].effective_num + '年</span>' + data[i].sk_dis_level.level_name +
                    '权益</div><div class="buy_btn">立即购买</div></div>';
            } else if (data[i].effective_cycle == 3) {
                html += '<div class="vip_del"><div class="vip_left"><span class="vip_level"><img src="../../image/ic_shop_zeng.jpg" alt=""></span>可获<span class="red_color">永久</span>' + data[i].sk_dis_level.level_name +
                    '权益</div><div class="buy_btn">立即购买</div></div>';
            }

            html += '</div>';
            html += '</div>';
        }
        if (isPull) {
            $api.byId('list').innerHTML = html;
        } else {
            $api.byId('list').innerHTML += html;
        }
    }

    function openVipGoodDel(id) {
        api.openWin({
            name: 'vip_goods_del_win',
            url: './../vip_goods/vip_goods_del_win.html',
            pageParam: {
                goods_id: id
            }
        });

    }

    function fnOpenyxdd() {
        api.openWin({
            name: 'vip_order_win',
            url: '../win/vip_order_win.html',
        });
    }

    function fnOpenVIPyqm() {
        api.openWin({
            name: 'vip_yqm_win',
            url: '../win/vip_yqm_win.html',
        });
    }
</script>

</html>
