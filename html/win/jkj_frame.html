<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0" />
  <title>title</title>
  <link rel="stylesheet" type="text/css" href="../../css/api.css" />
  <link rel="stylesheet" type="text/css" href="../../css/style.css" />
  <link rel="stylesheet" type="text/css" href="../../css/swiper.min.css" />
  <style>
    html,body{
      width:100%;
      height:100%;
      background-color: #fff;
      overflow-x: hidden;
      overflow-y: auto;
    }

    header{
      height: 4.8rem;
      width: 100%;
      position: fixed;
      top:0;
      left: 0;
      z-index: 9999;
    }
      .jkj_name{
        width: 100%;
        height: 2.4rem;
        line-height: 2.4rem;
        text-align: center;
        color:#333;
      }
      #topNav {
          height: 2.4rem;
          width: 100%;
          overflow: hidden;
          font: 16px/32px hiragino sans gb, microsoft yahei, simsun;
          /*border-bottom: 1px solid #f8f8f8;*/
      }

      #topNav .swiper-slide {
          padding: 0 0.8rem;
          letter-spacing: 0.2rem;
          height: 2.4rem;
          width: auto;
          line-height: 2.4rem;
          text-align: center;
      }

      #topNav .swiper-slide span {
          display: block;
          font-size: 0.8rem;
      }

      #topNav .swiper-slide.active span {
          height: 80%;
          width: 100%;
          transform: scale(1.1);
          color: #FF2D2D;
          border-bottom: 2px solid #FF2D2D;
      }
  </style>
</head>

<body>
  <header id="header">
    <div class="jkj_name">九块九</div>
    <div id="topNav" class="swiper-container">
        <div class="swiper-wrapper" id="type">
            <!-- <div class="swiper-slide active"><span>精选</span></div>
            <div class="swiper-slide"><span>日用百货</span></div>
            <div class="swiper-slide"><span>美妆个护</span></div>
            <div class="swiper-slide"><span>食品</span></div>
            <div class="swiper-slide"><span>鞋包配饰</span></div>
            <div class="swiper-slide"><span>内衣袜子</span></div>
            <div class="swiper-slide"><span>女装</span></div>
            <div class="swiper-slide"><span>数码周边</span></div> -->
        </div>
    </div>
  </header>
  <div class="noWlan">
    <div class="nowlanItem">
      <div class="no_net"><img src="../../image/no_net.png" /></div>
      <p class="no_p">网络竟然崩溃了</p>
      <p class="load_p">别紧张，试试看刷新页面</p>
      <div class="loadBtn" onclick="javascript:location.reload();">点击刷新</div>
    </div>
  </div>
</body>
  <script type="text/javascript" src="../../script/api.js"></script>
  <script type="text/javascript" src="../../script/jquery.js"></script>
  <script type="text/javascript" src="../../script/swiper.min.js"></script>
  <script type="text/javascript" src="../../script/api_common.js"></script>
  <script type="text/javascript">
    var headerHeight;
    var jkj_frameGroup=[];
    var frameGroup;
    apiready = function() {
      var header = $api.byId('header');
      $api.fixStatusBar(header);
      headerHeight = $api.offset(header).h;
      getjkjMenu();


    };
    function getjkjMenu(){
      api.ajax({
          url: 'http://m.sqkb.com/coupon/k9/cateTab',
          method: 'get',
          headers: {
              'Content-Type': 'application/json'
          },
          data: {
            body: {}
          }
      },function(ret, err){
          if (ret) {
            $(".noWlan").hide();
              var data=ret.data.tab_element;
              var html='';
              html+='<div class="swiper-slide" id="0"><span>精选</span></div>';
              for(var i=0;i<data.length;i++){
                html+='<div class="swiper-slide" id="'+data[i].cate_collection_id+'"><span>'+data[i].name+'</span></div>';
              }
              $api.byId('type').innerHTML=html;
              //分类菜单左右滑动
              var mySwiper = new Swiper('#topNav', {
                  freeMode: true,
                  freeModeMomentumRatio: 0.5,
                  slidesPerView: 'auto',
              });
              frameGroup=$(".swiper-slide");
              for(var i=0;i<frameGroup.length;i++){
                if(i==0){
                  jkj_frameGroup.push({
                      name: 'jkj_frames0' ,
                      url: 'jkj_frames0.html',
                      vScrollBarEnabled : false,
              				hScrollBarEnabled : false,
                      bounces:true,
                      pageParam: {
                          cate_collection_id:$(frameGroup[i]).attr("id")
                      }
                  });
                }else{
                  // alert("home："+home_group.item[i].cid);
                  jkj_frameGroup.push({
                      name: 'jkj_frames' + i,
                      url: 'jkj_frames.html',
                      vScrollBarEnabled : false,
              				hScrollBarEnabled : false,
                      bounces:true,
                      pageParam: {
                          cate_collection_id:$(frameGroup[i]).attr("id")
                      }
                  });
                }
              }
              frameGroup.click(function() {
          			var li_index = $(this).index();
          			$(this).addClass("active").siblings().removeClass("active");
          			api.setFrameGroupIndex({
          				name : 'jkj_frame',
          				index : li_index,
          				scroll : true,
          			});
          		});
              api.openFrameGroup({
                  name: 'jkj_frame',
                  scrollEnabled: true,  //frame 组是否能够左右滚动
                  rect: {
                      x: 0,
                      y: headerHeight,
                      w: 'auto',
                      h: api.winHeight - headerHeight-44
                  },
                  index: 0,
            			preload : 0,
                  frames: window['jkj_frameGroup']
              }, function(ret, err) {
                  var _index = ret.index;
                  // alert(JSON.stringify(ret));
                  frameGroup.eq(_index).addClass("active");
            			frameGroup.eq(_index).siblings().removeClass("active");
                  mySwiper.slideTo( _index-2);  //控制水平导航条滑动的位置，根据页面滑动而滑动
              });
              if(!empty($api.getStorage('jkj_frame_index'))){
                var slide=document.getElementsByClassName("swiper-slide");
                for(var j=0;j<slide.length;j++){
                  if(j==$api.getStorage('jkj_frame_index')){
                    slide[j].classList.add("active");
                  }
                }
                mySwiper.slideTo($api.getStorage('jkj_frame_index'));
              }
          } else {
            $(".noWlan").show();
              // alert( JSON.stringify( err ) );
          }
      });
    }
      </script>

      </html>
